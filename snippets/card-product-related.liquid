{%- comment -%}
  TZ Related Product Card - Matches main-collection-product-grid card structure
  RTL-First Theme
{%- endcomment -%}

{%- if card_product and card_product != empty -%}
  <a href="{{ card_product.url }}" class="tz-collection-product-item">
    <div class="tz-collection-product-image-container">
      {%- if card_product.available == false -%}
        <span class="tz-collection-product-badge tz-collection-product-badge--out-of-stock">{{ 'products.product.inventory_out_of_stock' | t }}</span>
      {%- elsif card_product.compare_at_price > card_product.price -%}
        <span class="tz-collection-product-badge tz-collection-product-badge--sale">{{ 'products.product.on_sale' | t }}</span>
      {%- endif -%}

      {%- if card_product.featured_image -%}
        <img
          alt="{{ card_product.featured_image.alt | escape }}"
          class="tz-collection-product-image"
          src="{{ card_product.featured_image | image_url: width: 600 }}"
          loading="lazy"
        >
      {%- endif -%}
    </div>

    <h3 class="tz-collection-product-title">{{ card_product.title | escape }}</h3>

    <div class="tz-collection-product-price{% if card_product.compare_at_price > card_product.price %} tz-collection-product-price--with-sale{% endif %}">
      {%- if card_product.compare_at_price > card_product.price -%}
        <span class="tz-collection-product-price-current">{{ card_product.price | money }}</span>
        <span class="tz-collection-product-price-original">{{ card_product.compare_at_price | money }}</span>
      {%- else -%}
        {{ card_product.price | money }}
      {%- endif -%}
    </div>

    {%- comment -%} Color Variants {%- endcomment -%}
    {%- if card_product.variants.size > 1 -%}
      <div class="tz-collection-product-variants">
        {%- for variant in card_product.variants limit: 4 -%}
          {%- assign variant_bg = '#6b7280' -%}
          {%- if variant.option1 contains 'שחור' or variant.option1 contains 'black' -%}
            {%- assign variant_bg = '#000000' -%}
          {%- elsif variant.option1 contains 'לבן' or variant.option1 contains 'white' -%}
            {%- assign variant_bg = '#e5e7eb' -%}
          {%- elsif variant.option1 contains 'אפור' or variant.option1 contains 'gray' -%}
            {%- assign variant_bg = '#6b7280' -%}
          {%- elsif variant.option1 contains 'כתום' or variant.option1 contains 'orange' -%}
            {%- assign variant_bg = '#f97316' -%}
          {%- elsif variant.option1 contains 'ירוק' or variant.option1 contains 'green' -%}
            {%- assign variant_bg = '#14532d' -%}
          {%- endif -%}
          <div class="tz-collection-variant-swatch" style="background-color: {{ variant_bg }}"></div>
        {%- endfor -%}
      </div>
    {%- endif -%}
  </a>
{%- endif -%}

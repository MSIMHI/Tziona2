{% style %}
  /* =========================================================
     TZ Main Footer — Liquid (TOKENS ONLY)
     ========================================================= */

  #shopify-section-{{ section.id }}{
    --tz-pt: {{ section.settings.padding_top }}px;
    --tz-pb: {{ section.settings.padding_bottom }}px;
    --tz-bg: {{ section.settings.bg_color }};
    --tz-t-color: {{ section.settings.text_color }};
    --tz-h-color: {{ section.settings.heading_color }};

    --tz-border: {{ section.settings.text_color | color_modify: 'alpha', 0.10 }};
    --tz-nl-input-bg-default: {{ section.settings.text_color | color_modify: 'alpha', 0.08 }};

    --tz-heading-font:
      {% case section.settings.heading_font_family %}
        {% when 'heading' %} var(--font-heading-family, inherit)
        {% when 'body' %} var(--font-body-family, inherit)
        {% else %} inherit
      {% endcase %};

    --tz-text-font:
      {% case section.settings.text_font_family %}
        {% when 'heading' %} var(--font-heading-family, inherit)
        {% when 'body' %} var(--font-body-family, inherit)
        {% else %} inherit
      {% endcase %};
  }

  /* Per-block CSS variables (no inline styles) */
  {% for block in section.blocks %}
    {% assign default_input_bg = section.settings.text_color | color_modify: 'alpha', 0.08 %}
    #shopify-section-{{ section.id }} .footer-col-dynamic[data-block-id="{{ block.id }}"]{
      --col-align:
        {% case block.settings.align %}
          {% when 'center' %} center
          {% when 'left' %} left
          {% when 'right' %} right
          {% else %} inherit
        {% endcase %};

      --col-h-color: {{ block.settings.heading_color | default: section.settings.heading_color }};
      --col-t-color: {{ block.settings.text_color | default: section.settings.text_color }};
      --col-link-color: {{ block.settings.link_color | default: block.settings.text_color | default: section.settings.text_color }};

      --col-h-size: {{ block.settings.heading_size | default: 14 }}px;
      --col-t-size: {{ block.settings.text_size | default: 14 }}px;

      --col-heading-font:
        {% case block.settings.font_family %}
          {% when 'heading' %} var(--font-heading-family, inherit)
          {% when 'body' %} var(--font-body-family, inherit)
          {% else %} var(--tz-heading-font)
        {% endcase %};

      --col-text-font:
        {% case block.settings.font_family %}
          {% when 'heading' %} var(--font-heading-family, inherit)
          {% when 'body' %} var(--font-body-family, inherit)
          {% else %} var(--tz-text-font)
        {% endcase %};

      --nl-input-bg: {{ block.settings.input_bg_color | default: default_input_bg }};
      --nl-input-color: {{ block.settings.input_text_color | default: block.settings.text_color | default: section.settings.text_color }};
      --nl-btn-bg: {{ block.settings.button_bg | default: block.settings.heading_color | default: section.settings.heading_color }};
      --nl-btn-text: {{ block.settings.button_text | default: '#ffffff' }};
      --nl-btn-radius: {{ block.settings.button_radius | default: 10 }}px;

      --img-width: {{ block.settings.image_width | default: 180 }}px;
      --img-radius: {{ block.settings.image_radius | default: 0 }}px;

      --icon-size: {{ block.settings.icon_size | default: 38 }}px;
      --icon-opacity: {{ block.settings.icon_opacity | default: 100 }}%;
      --icon-gap: {{ block.settings.icon_gap | default: 10 }}px;
    }
  {% endfor %}
{% endstyle %}

<section
  {% if section.settings.custom_id != blank %}
    id="{{ section.settings.custom_id | escape }}"
  {% endif %}
  class="tz-section tz-footer {{ section.settings.custom_class }} {% if section.settings.hide_mobile %}mobile-hide{% endif %} {% if section.settings.hide_desktop %}desktop-hide{% endif %}"
>
  <div class="tz-section__inner {{ section.settings.section_width }}">
    <div class="tz-section__content {{ section.settings.content_align }}">
      <div class="footer-dynamic-wrapper">
        <!-- TOP GRID -->
        <div class="footer-top-grid">
          {% for block in section.blocks %}
            <div
              class="footer-col-dynamic"
              data-block-id="{{ block.id }}"
              {{ block.shopify_attributes }}
            >
              {% unless block.type == 'payment_icons' %}
                {% if block.settings.heading != blank %}
                  <h4>{{ block.settings.heading }}</h4>
                {% endif %}
              {% endunless %}

              {% case block.type %}
                {% when 'text_column' %}
                  {{ block.settings.text }}

                {% when 'menu_column' %}
                  <ul>
                    {% for link in linklists[block.settings.menu].links %}
                      <li>
                        <a href="{{ link.url }}">{{ link.title }}</a>
                      </li>
                    {% endfor %}
                  </ul>

                {% when 'newsletter' %}
                  <div class="tz-newsletter">
                    {% if block.settings.text != blank %}
                      <div class="rte">{{ block.settings.text }}</div>
                    {% endif %}

                    {% form 'customer', class: 'tz-newsletter__form' %}
                      <input type="hidden" name="contact[tags]" value="newsletter">
                      <input
                        class="tz-newsletter__input"
                        type="email"
                        name="contact[email]"
                        autocorrect="off"
                        autocapitalize="off"
                        autocomplete="email"
                        placeholder="{{ block.settings.placeholder | default: 'Email' }}"
                        required
                      >
                      <button class="tz-newsletter__btn" type="submit">
                        {{ block.settings.button_label | default: 'Subscribe' }}
                      </button>
                    {% endform %}
                  </div>

                {% when 'image' %}
                  {% assign img = block.settings.image %}
                  {% if img != blank %}
                    <div class="tz-footer-image {% case block.settings.align %}{% when 'center' %}is-center{% when 'right' %}is-right{% else %}is-left{% endcase %}">
                      {% if block.settings.link != blank %}
                        <a href="{{ block.settings.link }}">
                          <img
                            src="{{ img | image_url: width: 800 }}"
                            alt="{{ block.settings.alt | default: img.alt | escape }}"
                            loading="lazy"
                          >
                        </a>
                      {% else %}
                        <img
                          src="{{ img | image_url: width: 800 }}"
                          alt="{{ block.settings.alt | default: img.alt | escape }}"
                          loading="lazy"
                        >
                      {% endif %}
                    </div>
                  {% endif %}

                {% when 'payment_icons' %}
                  <div class="tz-payment-icons {% case block.settings.align %}{% when 'center' %}is-center{% when 'right' %}is-right{% else %}is-left{% endcase %}">
                    {% if block.settings.show_heading and block.settings.heading != blank %}
                      <h4>{{ block.settings.heading }}</h4>
                    {% endif %}
                    <div class="payment-icons-list">
                      {% for type in shop.enabled_payment_types %}
                        {{ type | payment_type_svg_tag: class: 'icon icon--full-color' }}
                      {% endfor %}
                    </div>
                  </div>
              {% endcase %}
            </div>
          {% endfor %}
        </div>

        <!-- WATERMARK -->
        {% if section.settings.watermark != blank %}
          <div class="footer-watermark">{{ section.settings.watermark }}</div>
        {% endif %}

        <!-- BOTTOM BAR -->
        <div class="footer-bottom-bar">
          <div class="copyright-text">
            &copy; {{ 'now' | date: '%Y' }}, {{ shop.name }}. {{ section.settings.copyright_text }}
          </div>

          {% if section.settings.show_social %}
            <div class="social-icons-container">
              {%- if settings.social_facebook_link != blank -%}
                <a href="{{ settings.social_facebook_link }}" class="social-icon-link" aria-label="Facebook">
                  {% render 'icon-facebook' %}
                </a>
              {%- endif -%}
              {%- if settings.social_instagram_link != blank -%}
                <a href="{{ settings.social_instagram_link }}" class="social-icon-link" aria-label="Instagram">
                  {% render 'icon-instagram' %}
                </a>
              {%- endif -%}
              {%- if settings.social_tiktok_link != blank -%}
                <a href="{{ settings.social_tiktok_link }}" class="social-icon-link" aria-label="TikTok">
                  {% render 'icon-tiktok' %}
                </a>
              {%- endif -%}
              {%- if settings.social_youtube_link != blank -%}
                <a href="{{ settings.social_youtube_link }}" class="social-icon-link" aria-label="YouTube">
                  {% render 'icon-youtube' %}
                </a>
              {%- endif -%}
            </div>
          {% endif %}

          <!-- DARK MODE DROPDOWN -->
          <div class="footer-dark-mode-dropdown">
            <button class="dark-mode-dropdown-trigger" aria-label="Theme options" aria-expanded="false">
              <svg class="dark-mode-dropdown-icon" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
              </svg>
              <span class="dropdown-arrow">▼</span>
            </button>
            <div class="dark-mode-dropdown-menu" hidden>
              <button class="dark-mode-option" data-theme="light">
                <svg class="theme-icon" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <circle cx="12" cy="12" r="5"></circle>
                  <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
                </svg>
                Light Mode
              </button>
              <button class="dark-mode-option active" data-theme="dark">
                <svg class="theme-icon" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                Dark Mode
              </button>
              <button class="dark-mode-option" data-theme="auto">
                <svg class="theme-icon" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
                  <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                  <line x1="8" y1="21" x2="16" y2="21"></line>
                  <line x1="12" y1="17" x2="12" y2="21"></line>
                </svg>
                Auto (System)
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "TZ Main Footer",
  "tag": "section",
  "class": "section-footer",
  "settings": [
    { "type": "header", "content": "Layout" },
    {
      "type": "select",
      "id": "section_width",
      "label": "Section Width",
      "options": [
        { "value": "page-width", "label": "Page Width" },
        { "value": "full-width", "label": "Full Width" }
      ],
      "default": "page-width"
    },
    {
      "type": "select",
      "id": "content_align",
      "label": "Content Alignment",
      "options": [
        { "value": "is-left", "label": "Left" },
        { "value": "is-center", "label": "Center" },
        { "value": "is-right", "label": "Right" }
      ],
      "default": "is-left"
    },

    { "type": "header", "content": "Typography" },
    {
      "type": "select",
      "id": "heading_font_family",
      "label": "Heading font family",
      "options": [
        { "value": "inherit", "label": "Inherit" },
        { "value": "heading", "label": "Theme heading font" },
        { "value": "body", "label": "Theme body font" }
      ],
      "default": "inherit"
    },
    {
      "type": "select",
      "id": "text_font_family",
      "label": "Text font family",
      "options": [
        { "value": "inherit", "label": "Inherit" },
        { "value": "body", "label": "Theme body font" },
        { "value": "heading", "label": "Theme heading font" }
      ],
      "default": "inherit"
    },

    { "type": "header", "content": "Spacing" },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding Top",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 20
    },

    { "type": "header", "content": "Colors" },
    { "type": "color", "id": "bg_color", "label": "Background Color", "default": "#000000" },
    { "type": "color", "id": "heading_color", "label": "Heading Color", "default": "#ffffff" },
    { "type": "color", "id": "text_color", "label": "Text Color", "default": "#cccccc" },

    { "type": "header", "content": "Visibility" },
    { "type": "checkbox", "id": "hide_mobile", "label": "Hide on Mobile", "default": false },
    { "type": "checkbox", "id": "hide_desktop", "label": "Hide on Desktop", "default": false },

    { "type": "header", "content": "Content" },
    { "type": "text", "id": "watermark", "label": "Watermark Text", "default": "ציונה" },
    { "type": "checkbox", "id": "show_social", "label": "Show Social Icons", "default": true },
    { "type": "richtext", "id": "copyright_text", "label": "Copyright Text" },

    { "type": "header", "content": "Advanced" },
    { "type": "text", "id": "custom_id", "label": "Custom ID" },
    { "type": "text", "id": "custom_class", "label": "Custom Class" }
  ],
  "blocks": [
    {
      "type": "text_column",
      "name": "Text Column",
      "settings": [
        { "type": "text", "id": "heading", "label": "Heading", "default": "אודות" },
        { "type": "richtext", "id": "text", "label": "Text", "default": "<p>טקסט לדוגמה כאן...</p>" },

        { "type": "header", "content": "Styling" },
        {
          "type": "select",
          "id": "align",
          "label": "Alignment",
          "options": [
            { "value": "left", "label": "Left" },
            { "value": "center", "label": "Center" },
            { "value": "right", "label": "Right" }
          ],
          "default": "left"
        },
        { "type": "color", "id": "heading_color", "label": "Heading color" },
        { "type": "color", "id": "text_color", "label": "Text color" },
        {
          "type": "range",
          "id": "heading_size",
          "label": "Heading size",
          "min": 10,
          "max": 28,
          "step": 1,
          "unit": "px",
          "default": 14
        },
        {
          "type": "range",
          "id": "text_size",
          "label": "Text size",
          "min": 10,
          "max": 22,
          "step": 1,
          "unit": "px",
          "default": 14
        },
        {
          "type": "select",
          "id": "font_family",
          "label": "Font family",
          "options": [
            { "value": "inherit", "label": "Inherit section" },
            { "value": "body", "label": "Theme body font" },
            { "value": "heading", "label": "Theme heading font" }
          ],
          "default": "inherit"
        }
      ]
    },
    {
      "type": "menu_column",
      "name": "Menu Column",
      "settings": [
        { "type": "text", "id": "heading", "label": "Heading", "default": "קישורים" },
        { "type": "link_list", "id": "menu", "label": "Menu" },

        { "type": "header", "content": "Styling" },
        {
          "type": "select",
          "id": "align",
          "label": "Alignment",
          "options": [
            { "value": "left", "label": "Left" },
            { "value": "center", "label": "Center" },
            { "value": "right", "label": "Right" }
          ],
          "default": "left"
        },
        { "type": "color", "id": "heading_color", "label": "Heading color" },
        { "type": "color", "id": "text_color", "label": "Text color" },
        { "type": "color", "id": "link_color", "label": "Link color" },
        {
          "type": "range",
          "id": "heading_size",
          "label": "Heading size",
          "min": 10,
          "max": 28,
          "step": 1,
          "unit": "px",
          "default": 14
        },
        {
          "type": "range",
          "id": "text_size",
          "label": "Text size",
          "min": 10,
          "max": 22,
          "step": 1,
          "unit": "px",
          "default": 14
        },
        {
          "type": "select",
          "id": "font_family",
          "label": "Font family",
          "options": [
            { "value": "inherit", "label": "Inherit section" },
            { "value": "body", "label": "Theme body font" },
            { "value": "heading", "label": "Theme heading font" }
          ],
          "default": "inherit"
        }
      ]
    },
    {
      "type": "newsletter",
      "name": "Newsletter",
      "settings": [
        { "type": "text", "id": "heading", "label": "Heading", "default": "Newsletter" },
        { "type": "richtext", "id": "text", "label": "Text", "default": "<p>Sign up for updates.</p>" },
        { "type": "text", "id": "placeholder", "label": "Email placeholder", "default": "Email" },
        { "type": "text", "id": "button_label", "label": "Button label", "default": "Subscribe" },

        { "type": "header", "content": "Styling" },
        {
          "type": "select",
          "id": "align",
          "label": "Alignment",
          "options": [
            { "value": "left", "label": "Left" },
            { "value": "center", "label": "Center" },
            { "value": "right", "label": "Right" }
          ],
          "default": "left"
        },
        { "type": "color", "id": "heading_color", "label": "Heading color" },
        { "type": "color", "id": "text_color", "label": "Text color" },
        {
          "type": "range",
          "id": "heading_size",
          "label": "Heading size",
          "min": 10,
          "max": 28,
          "step": 1,
          "unit": "px",
          "default": 14
        },
        {
          "type": "range",
          "id": "text_size",
          "label": "Text size",
          "min": 10,
          "max": 22,
          "step": 1,
          "unit": "px",
          "default": 14
        },
        {
          "type": "select",
          "id": "font_family",
          "label": "Font family",
          "options": [
            { "value": "inherit", "label": "Inherit section" },
            { "value": "body", "label": "Theme body font" },
            { "value": "heading", "label": "Theme heading font" }
          ],
          "default": "inherit"
        },

        { "type": "color", "id": "input_bg_color", "label": "Input background" },
        { "type": "color", "id": "input_text_color", "label": "Input text color" },
        { "type": "color", "id": "button_bg", "label": "Button background" },
        { "type": "color", "id": "button_text", "label": "Button text color" },
        {
          "type": "range",
          "id": "button_radius",
          "label": "Button radius",
          "min": 0,
          "max": 40,
          "step": 2,
          "unit": "px",
          "default": 10
        }
      ]
    },
    {
      "type": "image",
      "name": "Image",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Image" },
        { "type": "url", "id": "link", "label": "Link (optional)" },
        { "type": "text", "id": "alt", "label": "Alt text (optional)" },

        { "type": "header", "content": "Layout" },
        {
          "type": "select",
          "id": "align",
          "label": "Alignment",
          "options": [
            { "value": "left", "label": "Left" },
            { "value": "center", "label": "Center" },
            { "value": "right", "label": "Right" }
          ],
          "default": "left"
        },
        {
          "type": "range",
          "id": "image_width",
          "label": "Image width",
          "min": 60,
          "max": 320,
          "step": 10,
          "unit": "px",
          "default": 180
        },
        {
          "type": "range",
          "id": "image_radius",
          "label": "Image radius",
          "min": 0,
          "max": 40,
          "step": 2,
          "unit": "px",
          "default": 0
        }
      ]
    },
    {
      "type": "payment_icons",
      "name": "Payment Icons",
      "settings": [
        { "type": "text", "id": "heading", "label": "Heading", "default": "Payment Methods" },
        { "type": "checkbox", "id": "show_heading", "label": "Show Heading", "default": true },
        { "type": "header", "content": "Styling" },
        {
          "type": "select",
          "id": "align",
          "label": "Alignment",
          "options": [
            { "value": "left", "label": "Left" },
            { "value": "center", "label": "Center" },
            { "value": "right", "label": "Right" }
          ],
          "default": "left"
        },
        {
          "type": "range",
          "id": "icon_size",
          "label": "Icon Size",
          "min": 16,
          "max": 48,
          "step": 2,
          "unit": "px",
          "default": 38
        },
        {
          "type": "range",
          "id": "icon_opacity",
          "label": "Icon Opacity",
          "min": 20,
          "max": 100,
          "step": 10,
          "unit": "%",
          "default": 100
        },
        {
          "type": "range",
          "id": "icon_gap",
          "label": "Icon Gap",
          "min": 4,
          "max": 24,
          "step": 2,
          "unit": "px",
          "default": 10
        }
      ]
    }
  ],
  "presets": [{ "name": "TZ Main Footer" }]
}
{% endschema %}
